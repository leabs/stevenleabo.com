<script>
  fetch(
    "https://www.googleapis.com/youtube/v3/search?key={{site.data.env.GOOGLEAPI}}&channelId={{site.data.env.CHANNELID}}&part=snippet,id&order=date&maxResults=20"
  )
    .then((response) => response.text())
    .then((data) => {
      console.log(data);
      //Get info from the last 3 videos
      const videos = JSON.parse(data).items.slice(0, 3);
      const titles = videos.map((video) => video.snippet.title);
      const descriptions = videos.map((video) => video.snippet.description);
      const thumbnails = videos.map(
        (video) => video.snippet.thumbnails.medium.url
      );
      const ids = videos.map((video) => video.id.videoId);
      const links = ids.map((id) => `https://www.youtube.com/watch?v=${id}`);
      //render the videos
      const videosDiv = document.getElementById("video-container");
      videosDiv.innerHTML = titles
        .map((title, index) => {
          return `
          <article style="margin-top: 0; margin-bottom: 2rem; background: transparent">
            <div style="align-items: center">
              <img src="${thumbnails[index]}" alt="${title} Thumbnail " width="320" height="180" style="margin-bottom:1rem;" />
              <h3>${title}</h3>

              <p>
                ${descriptions[index]}
              </p>
              <div class="button-wrapper">
                <a
                  style="background: #fff"
                  class="button"
                  href="${links[index]}"
                  >Watch Now</a
                >
              </div>
            </div>
          </article>
        `;
        })
        .join("");
    });
</script>

<section id="videos" style="margin-top: 0; margin-bottom: 0">
  <div class="container" style="margin-top: 0">
    <h2>Latest Videos:</h2>
    <div class="grid" id="video-container"></div>
  </div>
</section>
